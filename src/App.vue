<template>
<div id="app" :style="{
      '--background': background, 
      '--btn-color': btnColor, 
      '--box-shadow': boxShadow.shadow,
      '--hover-shadow': boxShadow.hover,
      '--btn-font-color': btnFontColor,
      '--font-color': fontColor
      }
    ">
    <div id="wrap">
        <div id="nav">
            <Nav :routes="routes" />
        </div>
        <router-view />
    </div>
</div>
</template>

<script>
import Nav from '@/components/Nav.vue'
export default {
    components: {
        Nav
    },
    created() {
        const conf = this.$store.state.config
        document.title = conf.buttonName
        const head = document.getElementsByTagName('head')[0]
        const iconfont = document.createElement('link')
        iconfont.type = 'text/css'
        iconfont.rel = 'stylesheet'
        iconfont.href = conf.iconfont
        Object.entries(conf.meta).forEach(function (entry) {
            const meta = document.createElement('meta')
            meta.setAttribute("property", entry[0])
            meta.content = entry[1]
            head.appendChild(meta)
        })
        head.appendChild(iconfont)
    },
    mounted() {
        window.vue = this
    },
    methods: {
        locale(lang) {
            this.locale = lang;
        }
    },
    computed: {
        routes: function () {
            return this.$store.state.config.routes
        },
        colorChoosed: function () {
            return this.$store.getters.color
        },
        background: function () {
            return this.colorChoosed.background
        },
        btnColor: function () {
            return this.colorChoosed.btnColor
        },
        btnFontColor: function () {
            return this.colorChoosed.btnFontColor
        },
        fontColor: function () {
            return this.colorChoosed.fontColor
        },
        boxShadow: function () {
            const bs = this.colorChoosed.boxShadow; // Box Shadow
            const i = this.colorChoosed.distance || 10; // distance
            const b = this.colorChoosed.blur || 2 * i; // blur
            return {
                shadow: `${i}px ${i}px ${b}px ${bs[0]}, -${i}px -${i}px ${b}px ${bs[1]}`,
                hover: `${i}px ${i}px 4px ${bs[0]}, -${i}px -${i}px 4px ${bs[1]}`
            }
        }
    }
}
</script>

<style>
html body {
    width: 100vw;
    min-height: 100vh;
    margin: 0;
    background: var(--background);
}

#wrap {
    max-width: 70rem;
    margin: auto;
}

#app {
    font-family: Avenir, Helvetica, Arial, sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-align: center;
    color: var(--btn-font-color);
    padding: 0.2rem;
    background-color: var(--background);
    min-height: 100vh;
    box-sizing: border-box;
}

#nav a {
    font-weight: bold;
    color: var(--btn-font-color);
}

#nav a.router-link-exact-active {
    color: var(--btn-font-color);
}
</style>
